def matrix_multiply(A, B):\n    if len(A[0]) != len(B):\n        raise ValueError('Matrices cannot be multiplied due to dimension mismatch.')\n    return [[sum(a * b for a, b in zip(A_row, B_col)) for B_col in zip(*B)] for A_row in A]\n\ndef transpose(matrix):\n    return [list(row) for row in zip(*matrix)]\n\ndef forward_pass(input_data, weights):\n    return matrix_multiply(input_data, weights)\n\ndef backward_pass(gradient, weights):\n    transposed_weights = transpose(weights)\n    return matrix_multiply(gradient, transposed_weights)\n\ndef compute_weight_gradients(inputs, gradients):\n    return matrix_multiply(transpose(inputs), gradients)\n